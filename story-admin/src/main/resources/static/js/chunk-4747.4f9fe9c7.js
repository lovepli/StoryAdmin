(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4747"],{"+lO3":function(e,t,a){"use strict";var i={props:{name:{type:String,default:""}}},n=(a("XO2W"),a("ZrdR")),r=Object(n.a)(i,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"section-title"},[t("span",{staticClass:"section-title__tag"}),this._v(" "),t("span",{staticClass:"section-title__name"},[this._v(this._s(this.name))])])},[],!1,null,"66bd56f3",null);r.options.__file="SectionTile.vue";var l=r.exports;a.d(t,"a",function(){return l})},"07d/":function(e,t,a){"use strict";var i=a("c4i5");a.n(i).a},"3wkR":function(e,t,a){},CB0q:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return n});a("Q2cO"),a("Vkta"),a("rerW"),a("+XIM");function i(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}!function(e,t){var a=t-e+1;Math.floor(e+Math.random()*a)}(2,10);function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){},a=document.getElementById(e);if(a)t(null,a);else{var i=document.createElement("script");i.src=e,i.id=e,document.body.appendChild(i),i.onload=function(){t(null,i)},i.onerror=function(){t(new Error("“"+e+"”加载失败"),i)}}}},Cstc:function(e,t,a){"use strict";var i=a("3wkR");a.n(i).a},DX0T:function(e,t,a){var i=a("fCtq"),n=a("S3Oy")(!0);i(i.S,"Object",{entries:function(e){return n(e)}})},GszX:function(e,t,a){},IqjM:function(e,t,a){"use strict";a.r(t);var i=a("uRWE");a.d(t,"default",function(){return i.default})},QabU:function(e,t,a){"use strict";var i=a("gK2b");a.n(i).a},S3Oy:function(e,t,a){var i=a("Xp5O"),n=a("S5+y"),r=a("iorM"),l=a("DMUv").f;e.exports=function(e){return function(t){for(var a,s=r(t),o=n(s),c=o.length,u=0,d=[];c>u;)a=o[u++],i&&!l.call(s,a)||d.push(e?[a,s[a]]:s[a]);return d}}},Vkta:function(e,t,a){e.exports={default:a("chwg"),__esModule:!0}},WJu6:function(e,t,a){},XO2W:function(e,t,a){"use strict";var i=a("paHQ");a.n(i).a},c4i5:function(e,t,a){},chwg:function(e,t,a){a("DX0T"),e.exports=a("zpmP").Object.entries},eSqZ:function(e,t,a){"use strict";var i=a("WJu6");a.n(i).a},eeAJ:function(e,t,a){"use strict";var i=a("GszX");a.n(i).a},gK2b:function(e,t,a){},paHQ:function(e,t,a){},uRWE:function(e,t,a){"use strict";a.r(t);var i=a("cLjf"),n=a.n(i),r=a("hDQ3"),l=a.n(r),s=a("bS4n"),o=a.n(s),c=a("A6HP"),u=a.n(c),d=(a("6ZY3"),a("EPZ6"),a("CB0q")),p=function(e,t){return e.find(function(e){return e.id===t})},m=new(a("Mpsw").default),f={props:{value:{type:String,default:""},action:{required:!0,type:String,default:""},name:{type:String,default:"file"},round:{type:Boolean,default:!0},sizeLimit:{type:Number,default:2},width:{type:String,default:"120px"}},data:function(){return{loading:!1}},computed:{style:function(){return{backgroundImage:"url("+(this.value||"")+")",width:this.width,height:this.width,borderRadius:this.round?"50% ":"6%"}}},methods:{beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<this.sizeLimit;t||this.$message.error("上传的图片只能是jpg或png格式!"),a||this.$message.error("上传的图片大小不能超过 "+this.sizeLimit+"MB!");var i=t&&a;return i&&(this.loading=!0),i},handleSuccess:function(e,t){this.loading=!1,e.success?this.$emit("input",e.data.url):this.$message.error(e.message||"上传失败")}}},h=(a("07d/"),a("eeAJ"),a("ZrdR")),g=Object(h.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{staticClass:"avatar-upload",style:e.style,attrs:{action:e.action,name:e.name,"show-file-list":!1,"before-upload":e.beforeUpload,"on-success":e.handleSuccess,accept:"image/jpeg,image/png"}},[e.loading||!e.value?a("i",{staticClass:"avatar-upload__icon",class:e.loading?"el-icon-loading":"el-icon-plus",style:{lineHeight:this.width}}):e._e()])},[],!1,null,"5b9bbb44",null);g.options.__file="AvatarUpload.vue";var v=g.exports,b={props:{value:{type:Array,default:function(){return[]}},action:{required:!0,type:String,default:""},name:{type:String,default:"file"},sizeLimit:{type:Number,default:10},tip:{type:String,default:""}},data:function(){return{loading:!1}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<this.sizeLimit;return t||this.$message.error("上传的文件小不能超过 "+this.sizeLimit+"MB!"),t&&(this.loading=!0),t},beforeRemove:function(e,t){return this.$confirm("确定删除“"+e.name+"”？")},handleSuccess:function(e,t,a){this.loading=!1,this.$emit("input",a)},handleRemove:function(e,t){this.$emit("input",t)},handlePreview:function(e){window.open(e.url)}}},y=(a("Cstc"),a("eSqZ"),Object(h.a)(b,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{staticClass:"drag-upload",attrs:{action:e.action,name:e.name,"file-list":e.value,"before-upload":e.beforeUpload,"before-remove":e.beforeRemove,"on-success":e.handleSuccess,"on-remove":e.handleRemove,"on-preview":e.handlePreview,drag:"",multiple:""}},[a("i",{staticClass:"drag-upload__icon",class:e.loading?"el-icon-loading":"el-icon-upload "}),e._v(" "),a("p",{staticClass:"drag-upload__text"},[e._v("点击或直接将文件拖到此处上传")]),e._v(" "),a("p",{staticClass:"drag-upload__tip"},[e._v("文件大小不能超过"+e._s(e.sizeLimit)+"MB！"+e._s(e.tip))])])],1)},[],!1,null,"e8e1dc64",null));y.options.__file="DragUpload.vue";var _=y.exports,w=a("+lO3"),D={props:{id:{type:String,default:function(){return"tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},height:{type:Number,default:500}},data:function(){return{hasInit:!1,hasInput:!1}},watch:{value:function(e){!this.hasInput&&this.hasInit&&tinymce.get(this.id).insertContent(e)}},mounted:function(){this.init()},destroyed:function(){this.destoryTinymce()},activated:function(){this.init()},deactivated:function(){this.destoryTinymce()},methods:{init:function(){var e=this;Object(d.b)("https://cdn.jsdelivr.net/npm/tinymce@5.1.2/tinymce.min.js",function(t,a){t?e.$message.error(t.message):e.initTinymce()})},initTinymce:function(){var e=this;tinymce.init({selector:"#"+this.id,language:"zh_CN",language_url:"/static/tinymce/langs/zh_CN.js",height:this.height,plugins:"advlist autosave autolink charmap code codesample emoticons fullscreen help hr image insertdatetime link lists media pagebreak paste preview print searchreplace table textpattern visualblocks visualchars wordcount",toolbar:"restoredraft | undo redo | styleselect | bold italic underline forecolor backcolor removeformat | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | table link image media emoticons charmap | searchreplace fullscreen preview code print",contextmenu:"copy paste link inserttable ",auto_focus:this.id,paste_enable_default_filters:!1,insertdatetime_formats:["%Y-%m-%d %H:%M:%S","%Y/%m/%d %H:%M:%S","%Y年%m月%d日 %H点%M分%S秒","%Y年%m月%d日","%H点%M分"],table_toolbar:"tableprops tablerowprops tablecellprops | tableinsertcolbefore tableinsertcolafter tabledeletecol | tableinsertrowbefore tableinsertrowafter tabledeleterow | tablemergecells tablesplitcells | tabledelete",link_context_toolbar:!0,link_assume_external_targets:!0,setup:function(e){},init_instance_callback:function(t){e.hasInit=!0,e.value&&t.insertContent(e.value),t.on("setContent keyup",function(){e.hasInput=!0,e.$emit("input",t.getContent())})},images_upload_handler:function(e,t,a){var i=e.blob(),n=e.base64(),r=i.type;"image/jpeg"===r?n="data:image/jpeg;base64,"+n:"image/png"===r?n="data:image/png;base64,"+n:"image/gif"===r&&(n="data:image/gif;base64,"+n);var l=new FormData;l.append("file",i),l.append("name",i.name),t(n)}})},destoryTinymce:function(){tinymce.get(this.id)&&tinymce.get(this.id).destroy()}}},x=Object(h.a)(D,function(){var e=this.$createElement;return(this._self._c||e)("textarea",{directives:[{name:"loading",rawName:"v-loading",value:!this.hasInit,expression:"!hasInit"}],staticStyle:{visibility:"hidden"},attrs:{id:this.id}})},[],!1,null,null,null);x.options.__file="Tinymce.vue";var k=x.exports,S={id:"",name:"",type:"",content:"",imageURL:"",brief:"",accessory:[]},C=[{id:"1",name:"新闻"},{id:"2",name:"财经"},{id:"3",name:"体育"},{id:"4",name:"娱乐"},{id:"5",name:"游戏"}],$=u.a.mock({"list|213":[{id:"@lower(@guid)",name:"@ctitle",author:"@cname",createDate:'@datetime("yyyy-MM-dd HH:mm:ss")',type:'@pick(["1", "2", "3", "4", "5"])',browseNum:"@natural(1000,9999)",imageURL:"https://source.unsplash.com/random/200x200",brief:"@cparagraph(1,3)",content:"@cparagraph",accessory:[{id:"1",name:"图片图片.jpg",url:"https://s2.ax1x.com/2019/08/02/edRc1P.jpg"},{id:"2",name:"营业执照副本.pdf",url:"http://www.xdocin.com/xdoc?_key=fedii4dtyfhmvgryqyntfjavte&_func=down&_dir=document.pdf"},{id:"3",name:"数据采集表",url:"http://www.xdocin.com/xdoc?_key=fedii4dtyfhmvgryqyntfjavte&_func=down&_dir=data.xlsx"}]}]}).list,j={name:"ArticleEdit",components:{AvatarUpload:v,DragUpload:_,SectionTitle:w.a,Tinymce:k},props:["articleId"],data:function(){return{articleType:[],articleDetail:o()({},S),formRules:{name:[{required:!0,message:"请填写文章标题",trigger:"blur"},{max:20,message:"标题不能超过20个字",trigger:"blur"}],type:[{required:!0,message:"请选择文章类型",trigger:"change"}],imageURL:[{required:!0,message:"请上传标题图片"}]},submitLoading:!1}},created:function(){this.getDetail(),this.articleType=C},methods:{getNowTime:function(){var e=this;return l()(n.a.mark(function t(){var a,i,r,l,s,o,c,u,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=new Date,i=void 0,r=void 0,l=void 0,s=void 0,o=void 0,c=void 0,u=[a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds()],i=u[0],r=u[1],l=u[2],s=u[3],o=u[4],c=u[5],d=new Date(i,r,l,s,o,c),console.log("获取系统当前时间："+d);case 11:case"end":return e.stop()}},t,e)}))()},getDetail:function(){var e=this;return l()(n.a.mark(function t(){var a,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.articleId?(a=e.articleId.id,i=p($,a)||$[0],e.articleDetail={id:i.id,name:i.name,imageURL:i.imageURL,type:i.type,brief:i.brief,content:i.content,accessory:i.accessory}):e.articleDetail=o()({},S);case 1:case"end":return t.stop()}},t,e)}))()},handleSubmit:function(){var e=this;this.$refs.form.validate(function(){var t=l()(n.a.mark(function t(a){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a?(e.submitLoading=!0,e.submitLoading=!1,e.$message.success("发布成功"),e.handleClose()):e.$message.error("请按照正确格式填写");case 1:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())},handleClose:function(){m.$emit("closeTag",this.$route.path),this.$router.push("/article/list")}}},R=(a("QabU"),Object(h.a)(j,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-edit"},[a("div",{staticClass:"article-edit__header"},[a("div",{staticClass:"title"},[a("section-title",{attrs:{name:e.articleId?"编辑文章":"新增文章"}})],1),e._v(" "),a("div",{staticClass:"operation"},[a("el-button",{attrs:{loading:e.submitLoading,type:"primary",icon:"el-icon-s-promotion"},on:{click:e.handleSubmit}},[e._v("发布")]),e._v(" "),a("el-button",{attrs:{type:"info",icon:"el-icon-circle-close"},on:{click:e.handleClose}},[e._v("取消")])],1)]),e._v(" "),a("el-row",[a("el-col",{attrs:{lg:16}},[a("tinymce",{attrs:{height:660},model:{value:e.articleDetail.content,callback:function(t){e.$set(e.articleDetail,"content",t)},expression:"articleDetail.content"}})],1),e._v(" "),a("el-col",{attrs:{lg:8}},[a("el-form",{ref:"form",staticClass:"article-edit__form",attrs:{model:e.articleDetail,rules:e.formRules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"文章标题:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.articleDetail.name,callback:function(t){e.$set(e.articleDetail,"name",t)},expression:"articleDetail.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文章类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择文章类型",clearable:""},model:{value:e.articleDetail.type,callback:function(t){e.$set(e.articleDetail,"type",t)},expression:"articleDetail.type"}},e._l(e.articleType,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"文章简介:"}},[a("el-input",{attrs:{rows:3,maxlength:100,type:"textarea",placeholder:"请输入文章简介",clearable:""},model:{value:e.articleDetail.brief,callback:function(t){e.$set(e.articleDetail,"brief",t)},expression:"articleDetail.brief"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"创建时间:",prop:"createDate"}},[a("el-input",{attrs:{disabled:""},model:{value:e.articleDetail.createDate,callback:function(t){e.$set(e.articleDetail,"createDate",t)},expression:"articleDetail.createDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标题图片:",prop:"imageURL"}},[a("avatar-upload",{attrs:{round:!1,action:"https://sm.ms/api/v2/upload",name:"smfile",width:"80px"},model:{value:e.articleDetail.imageURL,callback:function(t){e.$set(e.articleDetail,"imageURL",t)},expression:"articleDetail.imageURL"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"附件上传:"}},[a("drag-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts"},model:{value:e.articleDetail.accessory,callback:function(t){e.$set(e.articleDetail,"accessory",t)},expression:"articleDetail.accessory"}})],1)],1)],1)],1)],1)},[],!1,null,"80163910",null));R.options.__file="Edit.vue";t.default=R.exports}}]);